<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Recurrent neural networks for ornithopter trajectory optimization</title>

  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- REVEAL CSS-->
  <link rel="stylesheet" href="libs/reveal.js/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/css/reveal.css">
  
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/css/theme/Black.css" id="theme">
  
  
  <link rel="stylesheet" href="libs/reveal.js/3.8.0/plugin/title-footer/title-footer-mod.css" />

  <!-- MERMAID-->
  <script src="libs/reveal.js/3.8.0/plugin/mermaid/mermaid.min.js"></script>
  <style>
  .mermaid {
    font-size: 0.5em;
  }
  </style>

  <style>
    [class*=task-list-item] {
    min-height: 22px;
    margin-top: 6px!important;
    margin-bottom: 6px!important;
    padding-left: 0;
    list-style: none;
}

[class*=task-list-item]>input:first-child {
    position: absolute!important;
    opacity: 0;
    margin: 0;
}
[class*=task-list-item]>label {
    padding-left: 29px!important;
    min-height: 22px;
    line-height: 22px;
    display: inline-block;
    position: relative;
    vertical-align: top;
    margin-bottom: 0;
    font-weight: 400;
    cursor: pointer;
}

.task-list-item>input:first-child:checked+input[type=hidden]+label::before, .task-list-item>input:first-child:checked+label::before {
    background-color: #ecf0f1;
    border-color: #ecf0f1;
}

[class*=task-list-item]>input:first-child+input[type=hidden]+label::before, [class*=task-list-item]>input:first-child+label::before {
    content: "";
    display: inline-block;
    position: absolute;
    width: 22px;
    height: 22px;
    border: 1px solid #D3CFC8;
    border-radius: 0;
    margin-left: -29px;
}


[class*=task-list-item]>input:first-child:checked+input[type=hidden]+label::after, [class*=task-list-item]>input:first-child:checked+label::after {
    content: "";
    display: inline-block;
    position: absolute;
    top: 0;
    left: 0;
    width: 7px;
    height: 10px;
    border: 2px solid #fff;
    border-left: none;
    border-top: none;
    transform: translate(7.75px,4.5px) rotate(45deg);
    -ms-transform: translate(7.75px,4.5px) rotate(45deg);
}


.task-list-item>input:first-child:checked+input[type=hidden]+label::after, .task-list-item>input:first-child:checked+label::after {
    border-bottom-color: #95a5a6;
    border-right-color: #95a5a6;
}
  </style>

  <!-- Theme used for syntax highlighting of code -->
  
  <link rel="stylesheet" href="libs/highlight.js/9.12.0/monokai.css">
  

  
  
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'libs/reveal.js/3.8.0/css/print/pdf.css' : 'libs/reveal.js/3.8.0/css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>

  <style>
    /* Solarized Light theme */
     .line {
      display: block;
    }
    

    .line.focus {
      background: #fdf6e3;
      color: #657b83;
    }

/*
    .line.focus .hljs-comment,
    .line.focus .hljs-quote {
      color: #93a1a1;
    }

    .line.focus .hljs-keyword,
    .line.focus .hljs-selector-tag,
    .line.focus .hljs-addition {
      color: #859900;
    }

    .line.focus .hljs-number,
    .line.focus .hljs-string,
    .line.focus .hljs-meta .hljs-meta-string,
    .line.focus .hljs-literal,
    .line.focus .hljs-doctag,
    .line.focus .hljs-regexp {
      color: #2aa198;
    }

    .line.focus .hljs-title,
    .line.focus .hljs-section,
    .line.focus .hljs-name,
    .line.focus .hljs-selector-id,
    .line.focus .hljs-selector-class {
      color: #268bd2;
    }

    .line.focus .hljs-attribute,
    .line.focus .hljs-attr,
    .line.focus .hljs-variable,
    .line.focus .hljs-template-variable,
    .line.focus .hljs-class .hljs-title,
    .line.focus .hljs-type {
      color: #b58900;
    }

    .line.focus .hljs-symbol,
    .line.focus .hljs-bullet,
    .line.focus .hljs-subst,
    .line.focus .hljs-meta,
    .line.focus .hljs-meta .hljs-keyword,
    .line.focus .hljs-selector-attr,
    .line.focus .hljs-selector-pseudo,
    .line.focus .hljs-link {
      color: #cb4b16;
    }

    .line.focus .hljs-built_in,
    .line.focus .hljs-deletion {
      color: #dc322f;
    }

    .line.focus .hljs-formula {
      background: #eee8d5;
    }

    .line.focus .hljs-emphasis {
      font-style: italic;
    }

    .line.focus .hljs-strong {
      font-weight: bold;
    }

    .yellow-slide .line.focus:nth-child(2) {
      background: yellow;
    }

    .reveal .slides section .code-presenting-annotation {
      font-size: 70%;
    }
    */

    .reveal .slides section .fragment.current-only {
      visibility: visible;
      display: none;
    }

    .reveal .slides section .fragment.current-only.current-fragment {
      display: block;
    }

/*
    .line {
      display: block;
    }
*/
    .line.focus {
       opacity: 1.0;
    } 

    /* .hljs {
      background: none;
    } */

    /* .reveal pre {
      width: 98%;
      margin: 0px;
      box-shadow: none;
    }

    .reveal pre code {
      font-size: 1.2em;
      line-height: 1.2;
      border-radius: 10px;
      max-height: 60vh !important;
      overflow: hidden !important;
    } */

    @media (device-width: 100vw) and (device-height: 100vh) {
      .reveal pre code {
        max-height: 50vh !important;
      }
    }

    #logo img {
      max-height: 3.5em;
      max-width: none;
      min-width: 50px;
    }

    .reveal .slides section .code-presenting-annotation {
      color: white;
      background: black;
      padding: 0px 15px;
      border-radius: 15px;
      opacity: 0.75 !important;
      font-size: 50% !important;
    }
  </style>
  <script>
    if (window.location.search.match(/print-pdf-now/gi)) {
      window.print();
    }
  </script>
</head>

<body>
  
<div id="logo" style="position: fixed; top: 20px; left: 20px; z-index: 1">
    <img src="./images/QR paskymailweb.png" />
</div>


  <div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">

      


    
        <section >
            
            <div style="background:red;width:500px" class="block">
<p><em>Work in progress</em></p>
</div>

            </section>
    



    
        <section >
            
            <h2><a id="user-content-trabajo-fin-de-master" class="anchor" href="#trabajo-fin-de-master" aria-hidden="true"></a>Trabajo Fin de Master</h2>
<p>Recurrent neural networks for ornithopter trajectory optimization</p>
 <img data-src="./images/logo_US.png">
<p><small>Supervisor: José Miguel Díaz Báñez / Candidate: Luis David Pascual Callejo</small></p>

            </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-overview" class="anchor" href="#overview" aria-hidden="true"></a>Overview</h2>
<ol>
<li>Ornithopter trajectory optimization problem
<ol>
<li>OSPA approach</li>
<li>RNN approach</li>
</ol>
</li>
<li>Neural Networks preliminaries
<ol>
<li>Feedforward Neural Networks</li>
<li>NN’s parametric family</li>
<li>Universal Approximator theorem</li>
<li>Neural Network architecture</li>
<li>Recurrent Neural Network</li>
</ol>
</li>
</ol>

            </section>
        
            <section >
                <h2><a id="user-content-overview-1" class="anchor" href="#overview-1" aria-hidden="true"></a>Overview</h2>
<ol start="3">
<li>Propositions and basic results
<ol>
<li>Unfolding of RNN</li>
<li>Maximum likelihood method</li>
<li>ML for the regression problem</li>
<li>ML for the classification problem</li>
</ol>
</li>
<li>RNN implementation
<ol>
<li>Data pre-processing</li>
<li>Output layer
<ol>
<li>Classification</li>
<li>Regression</li>
</ol>
</li>
</ol>
</li>
</ol>

            </section>
        
            <section >
                <h2><a id="user-content-overview-2" class="anchor" href="#overview-2" aria-hidden="true"></a>Overview</h2>
<ol start="5">
<li>Results
<ol>
<li>Action classification model</li>
<li>Sequence to sequence model</li>
<li>Decoder model</li>
<li>ODE integrator model</li>
</ol>
</li>
<li>Conclusions</li>
</ol>

            </section>
        

    </section>
    



    
        <section data-transition="slide" data-background="#4d7e65" data-background-transition="zoom">
            
            <!-- .slide: data-transition="slide" data-background="#4d7e65" data-background-transition="zoom" -->
<h2><a id="user-content-1-ornithopter-trajectory-optimization-problem" class="anchor" href="#1-ornithopter-trajectory-optimization-problem" aria-hidden="true"></a>1. Ornithopter trajectory optimization problem</h2>
<img data-src="./images/ornithopter.jpg" width="40%">

            </section>
    



    
        <section >
            
            <h3><a id="user-content-11-problem-statement" class="anchor" href="#11-problem-statement" aria-hidden="true"></a>1.1 Problem statement</h3>
<img data-src="./images/trajectories.png" width="40%">
<blockquote>
<p><small>The problem we want to solve is to compute an optimal trajectory of an ornithopter connecting two given positions A and B while minimizing the energy consumption</small></p>
</blockquote>

            </section>
    



    
        <section >
            
            <h3><a id="user-content-12-the-ospa-approach" class="anchor" href="#12-the-ospa-approach" aria-hidden="true"></a>1.2 The OSPA approach</h3>
<p>OSPA (Ornithopter Segmentation Path Planning Approach) is a novel heuristic algorithm able to efficiently compute optimal trajectories.
However it is too slow to be embarked on the ornithopter for inline path computation.</p>

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-13-the-rnn-approach" class="anchor" href="#13-the-rnn-approach" aria-hidden="true"></a>1.3 The RNN approach</h3>
<blockquote>
<p><strong>Proposition:</strong> contour this problem using recurrent neuronal networks.</p>
</blockquote>
<p>The neuronal network is tasked with learning the underlying optimal trajectory flight dynamics, which are in turn numerically estimated by the OSPA.</p>

            </section>
        
            <section >
                <h3><a id="user-content-13-the-rnn-approach-1" class="anchor" href="#13-the-rnn-approach-1" aria-hidden="true"></a>1.3 The RNN approach</h3>
<p>More precisely, OSPA is used to compute a set of optimal trajectories for the ornithopter and then, the neuronal network is tasked with learning the underlying function from it.</p>
<blockquote>
<p>The goal is to obtain similar performances to the heuristic method with much faster computation times.</p>
</blockquote>

            </section>
        

    </section>
    



    
        <section data-transition="slide" data-background="#4e4d7e" data-background-transition="zoom">
            
            <!-- .slide: data-transition="slide" data-background="#4e4d7e" data-background-transition="zoom" -->
<h2><a id="user-content-2-neural-networks-preliminaries" class="anchor" href="#2-neural-networks-preliminaries" aria-hidden="true"></a>2. Neural Networks preliminaries</h2>

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-21-feedforward-neural-networks" class="anchor" href="#21-feedforward-neural-networks" aria-hidden="true"></a>2.1 Feedforward neural networks</h3>
<img data-src="./images/NN_schema.png">

            </section>
        
            <section >
                <h3><a id="user-content-21-feedforward-nn-algebraic-equations" class="anchor" href="#21-feedforward-nn-algebraic-equations" aria-hidden="true"></a>2.1 Feedforward NN algebraic equations</h3>
<img data-src="./images/Neuron_diagram.png" width="40%">
<small>
<span>
\[\begin{aligned}
&a_i^k = b_i^k + \sum_{j = 1}^{r_{k-1}} w_{ji}^k o_j^{k-1} = \sum_{j = 0}^{r_{k-1}} w_{ji}^k o_j^{k-1}\\
&o_i^k = g(a_i^k)
\end{aligned} \]
</span>
</small>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-22-nns-parametric-family" class="anchor" href="#22-nns-parametric-family" aria-hidden="true"></a>2.2 NN’s parametric family</h3>
<blockquote>
<p>These equations form a parametric family ${f^*(\cdot ,;\theta )\mid \theta \in \Theta }$.</p>
</blockquote>
<p>where the family $f^*(\cdot ,;\theta)$ is given by the NN architecture and the parameters $\theta$ correspond to the NN weights $w_{ji}^k$.</p>

            </section>
        
            <section >
                <h3><a id="user-content-22-nns-parametric-family-1" class="anchor" href="#22-nns-parametric-family-1" aria-hidden="true"></a>2.2 NN’s parametric family</h3>
<blockquote>
<p>The goal can be reformulated as getting the best approximate $f^{\ast}(x;\hat{\theta})$ to the true underlying function $f$, which is in turn characterized by the OSPA optimal trajectory data set.</p>
</blockquote>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-23-universal-approximator-theorem" class="anchor" href="#23-universal-approximator-theorem" aria-hidden="true"></a>2.3 Universal approximator theorem</h3>
<blockquote>
<p><strong>Theorem:</strong> feedforward networks with a linear output layer and at least one hidden layer with any continuous squashing function can approximate any Borel measurable function from one finite-dimensional space to another with any desired non-zero amount of error, provided that the network is given enough hidden units.</p>
</blockquote>

            </section>
        
            <section >
                <h3><a id="user-content-23-universal-approximator-theorem-1" class="anchor" href="#23-universal-approximator-theorem-1" aria-hidden="true"></a>2.3 Universal approximator theorem</h3>
<blockquote>
<p>Therefore $f^{\ast}(x;\hat{\theta})$ can approximate $f$ as much as desired</p>
</blockquote>
<p>This is true since a continuous function on a closed and bounded subset of $R^N$ is Borel measurable.</p>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-24-nn-architecture" class="anchor" href="#24-nn-architecture" aria-hidden="true"></a>2.4 NN architecture</h3>
<p>The neuronal network architecture and activation functions define the capacity the parametric family
$${f^\ast(\cdot ,;\theta )\mid \theta \in \Theta }$$</p>
<p>The capacity is determined by:</p>
<ul>
<li>Depth and width of the network: they will define the number of parameters available.</li>
<li>Activation functions and general architecture: they will define the set of functions that can be learned by the NN.</li>
</ul>

            </section>
        
            <section >
                <h3><a id="user-content-24-nn-architecture-1" class="anchor" href="#24-nn-architecture-1" aria-hidden="true"></a>2.4 NN architecture</h3>
<p>Due to the complexity of the ornithopter problem, our NN architecture must have the capacity to capture temporal dynamic behaviors.</p>
<blockquote>
<p><strong>Proposition:</strong>  use a recurrent neural network with just one single layer to learn the OSPA underlaying trajectory flight dynamics</p>
</blockquote>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-25-recurrent-neural-networks" class="anchor" href="#25-recurrent-neural-networks" aria-hidden="true"></a>2.5 Recurrent Neural networks</h3>
<p>A recurrent neural network (RNN) is a class of artificial neural networks where connections between nodes form a directed graph along a temporal sequence. These connections allow previous outputs to be used as inputs while having hidden states.</p>

            </section>
        
            <section >
                <h3><a id="user-content-25-recurrent-neural-networks-1" class="anchor" href="#25-recurrent-neural-networks-1" aria-hidden="true"></a>2.5 Recurrent Neural networks</h3>
<img data-src="./images/RNN gates.png" width="50%">
<small>
<span>
\[\begin{aligned}
&a_t =g_1( b_a + W_{aa}a_{t-1}+W_{ax}x_t) \\
&y_t = g_2(b_y + W_{ya}a_t)
\end{aligned} \]
</span>
</small>

            </section>
        

    </section>
    



    
        <section data-transition="slide" data-background="#e3be29" data-background-transition="zoom">
            
            <!-- .slide: data-transition="slide" data-background="#e3be29" data-background-transition="zoom" -->
<h2><a id="user-content-3-propositions-and-basic-results" class="anchor" href="#3-propositions-and-basic-results" aria-hidden="true"></a>3. Propositions and basic results</h2>

            </section>
    



    
        <section >
            
            <h2><a id="user-content-31-rnn-unfolding" class="anchor" href="#31-rnn-unfolding" aria-hidden="true"></a>3.1 RNN unfolding</h2>
<img data-src="./images/RNN architecture.png">

            </section>
    



    
    <section>
        <section >
            <h2><a id="user-content-31-rnn-unfolding-1" class="anchor" href="#31-rnn-unfolding-1" aria-hidden="true"></a>3.1 RNN unfolding</h2>
<small>
<blockquote>
<p><strong>Theorem:</strong> the unfolding property can only be applied if the following hypothesis is met: the conditional probability distribution over the variables at t+1 given the variables at time t, is stationary.
</small></p>
</blockquote>

            </section>
        
            <section >
                <h3><a id="user-content-31-rnn-unfolding-2" class="anchor" href="#31-rnn-unfolding-2" aria-hidden="true"></a>3.1 RNN unfolding</h3>
<blockquote>
<p><small>Therefore the RNN can be virtually considered as a feedforward NN and the results seen in <a href="#/1">1</a> and <a href="#/3">2</a> are still valid.</small></p>
</blockquote>
<p><small>This is true since for every tuple of starting and target points, it is expected to obtain the same optimal trajectory.  Therefore, considering the starting point as an intermediate point at time t of a longer trajectory with same target point,the following intermediary points are expected to be same.</small></p>

            </section>
        

    </section>
    



    
        <section >
            
            <h2><a id="user-content-32-maximum-likelihood" class="anchor" href="#32-maximum-likelihood" aria-hidden="true"></a>3.2 Maximum likelihood</h2>
<img data-src="./images/ML concept.png">

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-32-ml-to-estimate-optimal-parameters" class="anchor" href="#32-ml-to-estimate-optimal-parameters" aria-hidden="true"></a>3.2 ML to estimate optimal parameters</h3>
<small>
Now that our family is defined, we need to compute the parameters $\theta$ so to obtain the best approximate $f^{\ast}(x;\hat{\theta})$ to the true underlying function $f$.
<blockquote>
<p><strong>Proposition:</strong> the ML method is proposed to estimate the parameter value $\hat{\theta}$ for a given family, so that under the assumed model $f^{\ast}(x;\hat{\theta})$, the observed data is the most probable.
</small></p>
</blockquote>

            </section>
        
            <section >
                <h3><a id="user-content-32-ml-to-estimate-optimal-parameters-1" class="anchor" href="#32-ml-to-estimate-optimal-parameters-1" aria-hidden="true"></a>3.2 ML to estimate optimal parameters</h3>
<blockquote>
<p><small> <strong>Definition:</strong> Consider a set of $m$ examples $X ={x^1,…,x^m} $ drawn independently from the true but unknown data generating distribution $p_{data}(x)$. Let  $p_{model}(X; \theta)$ be a parametric family of probability distributions over the same space indexed by $\theta$. The maximum likelihood estimator for $\theta$ is then deﬁned as:</p>
</blockquote>
<script type="math/tex; mode=display">
  \theta_{ML} =  \arg\max_{\theta}  p_{model}(X;\theta) = \arg\max_{\theta}
\prod_{i=1}^m p_{model}(x_i ;\theta)
</script>
</small>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-33-regression-problem" class="anchor" href="#33-regression-problem" aria-hidden="true"></a>3.3 Regression problem</h3>
<small>
In the regression problem, the RNN aims to output the best possible approximation to the values of the true states in $R^6$ given by an OSPA trajectory.
<p>$$y_i = \hat{y_i} + e_i$$</p>
<p>where  $\hat{y_i}$ is our prediction, $y_i$ is the real value and $e_i$ is the error due to non modeled aspects which is assumed to be Gaussian
</small></p>

            </section>
        
            <section >
                <h3><a id="user-content-331-mean-squared-error" class="anchor" href="#331-mean-squared-error" aria-hidden="true"></a>3.3.1 Mean squared Error</h3>
<blockquote>
<p><small> <strong>Proposition:</strong> given the above mentioned hypothesis, it is equivalent to use the Log Likelihood or the Mean Squared Error as loss functions for our NN.</p>
</blockquote>
<script type="math/tex; mode=display">
   \theta_{ML} =  \arg\max_{\theta} L= \arg\max_{\theta}m\log\frac {1}{\sigma {\sqrt {2\pi }}}-\sum_{i=1}^m {\frac {1}{2}}\left({\frac {y_i - \hat{y_i}  }{\sigma }}\right)^{2} = \arg\max_{\theta}\sum_{i=1}^m {\frac {1}{2}}\left({y_i - \hat{y_i}  }\right)^{2}
</script>
</small>

            </section>
        
            <section >
                <h3><a id="user-content-332-kl-divergence" class="anchor" href="#332-kl-divergence" aria-hidden="true"></a>3.3.2 KL Divergence</h3>
<blockquote>
<p><small> <strong>Proposition:</strong>  It is equivalent to use the Log-likelihood or the KL divergence as loss functions to compute the optimal parameters for our NN regression problem.</p>
</blockquote>
<script type="math/tex; mode=display">
   \displaystyle D_{\text{KL}}(p_{data}\parallel p_{model})=-H_{p_{data}} - L(x;\theta)
</script>
</small>

            </section>
        
            <section >
                <h3><a id="user-content-332-kl-divergence-1" class="anchor" href="#332-kl-divergence-1" aria-hidden="true"></a>3.3.2 KL Divergence</h3>
<small>
The KL divergence loss function represents the amount of information lost when $p_{model}$ is used to approximate $p_{data}$.
<p>Or in other words, when our neural network $f^{\ast}(x;\hat{\theta})$ is used instead of the real source of data, which is our OSPA planner.
</small></p>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-34-classification-problem" class="anchor" href="#34-classification-problem" aria-hidden="true"></a>3.4 Classification problem</h3>
<small>
The ornithopter possible action data set is actually a finite set of 35 different action tuples. This is due to the methodology of the OSPA to compute the optimal path, which requires a finite set of possible action outcomes in order to obtain a search tree.
<p>In the classification model each action $a_k$ is treated as a different category, leading to 35 different categories: $$a_k = (\delta_k, f_k), \ k =1,…, 35$$</p>
</small>

            </section>
        
            <section >
                <h3><a id="user-content-34-classification-problem-1" class="anchor" href="#34-classification-problem-1" aria-hidden="true"></a>3.4 Classification problem</h3>
<small>
In this case, we want the RNN to output the probability that each category has to be selected:
 $$\hat{y_k} = p(y_k|x,\theta)$$
where $\hat{y_k}$ is the vector with the predicted probabilities for each category $k$ and $y_k$ is the "one hot" representation of each category
</small>

            </section>
        
            <section >
                <h3><a id="user-content-341-cross-entropy" class="anchor" href="#341-cross-entropy" aria-hidden="true"></a>3.4.1 Cross Entropy</h3>
<blockquote>
<p><small> <strong>Proposition:</strong> It is equivalent to use the Log-likelihood or the CategoricalCross Entropy as loss function for our NN classification problem.</p>
</blockquote>
<script type="math/tex; mode=display">
   \theta_{ML} =  \arg\max_{\theta} \sum_{i=1}^m \log p(y|x_i ;\theta)= \arg\max_{\theta} - \sum_{i=1}^m H(p(y_i), \hat{y}_i)
</script>
</small>

            </section>
        
            <section >
                <h3><a id="user-content-341-cross-entropy-1" class="anchor" href="#341-cross-entropy-1" aria-hidden="true"></a>3.4.1 Cross Entropy</h3>
<small>
The cross entropy loss function can be interpreted as the expected message-length per datum when a wrong distribution $p_{model}$ is assumed while the data actually follows a distribution $p_{data}$.
<p>Or in other words, when our neural network $f^{\ast}(x;\hat{\theta})$ is used instead of the real source of data, which is our OSPA planner.
</small></p>

            </section>
        
            <section >
                <h3><a id="user-content-342-kl-divergence" class="anchor" href="#342-kl-divergence" aria-hidden="true"></a>3.4.2 KL Divergence</h3>
<blockquote>
<p><small> <strong>Proposition:</strong>  It is equivalent to use the Log-likelihood or the KL divergence as loss functions to compute the optimal parameters for our NN classification problem.</p>
</blockquote>
<script type="math/tex; mode=display">
   \displaystyle D_{\text{KL}}(p(y)\parallel \hat{y})=-H_{y} + H_{y\hat{y}}(x;\theta)
</script>
</small>

            </section>
        

    </section>
    



    
        <section data-transition="slide" data-background="#b5533c" data-background-transition="zoom">
            
            <!-- .slide: data-transition="slide" data-background="#b5533c" data-background-transition="zoom" -->
<h2><a id="user-content-4-rnn-implementation" class="anchor" href="#4-rnn-implementation" aria-hidden="true"></a>4. RNN implementation</h2>

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-41-data-pre-processing" class="anchor" href="#41-data-pre-processing" aria-hidden="true"></a>4.1 data pre-processing</h3>
<ol>
<li>From states to state distances:
$$x_i = s_{target} - s_i$$</li>
<li>Data normalization:<br>
$$x_i = \frac{z_i }{\sigma}$$</li>
<li>Append target point to the trajectory
$$\vec{x}.append(x_{target})$$</li>
</ol>

            </section>
        
            <section >
                <h3><a id="user-content-41-data-pre-processing-1" class="anchor" href="#41-data-pre-processing-1" aria-hidden="true"></a>4.1 data pre-processing</h3>
<ul>
<li>
<p>Data truncation and padding</p>
<img data-src="./images/Padding.png">
</li>
</ul>

            </section>
        

    </section>
    



    
        <section >
            
            <h3><a id="user-content-42-output-layer" class="anchor" href="#42-output-layer" aria-hidden="true"></a>4.2 output layer</h3>

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-421-classification-output-layer" class="anchor" href="#421-classification-output-layer" aria-hidden="true"></a>4.2.1 classification output layer</h3>
<p>The output layer consists on a dense layer with a softmax activation function</p>
  <img data-src="./images/Output classif.png" width = "60%">
<p>It transforms the output into the probability of predicting each specific class</p>

            </section>
        
            <section >
                <h3><a id="user-content-421-classification-output-layer-1" class="anchor" href="#421-classification-output-layer-1" aria-hidden="true"></a>4.2.1 classification output layer</h3>
<blockquote>
<p><strong>Proposition:</strong> If we assume that $p(x|y^k=1)$ follows a Gaussian, a softmax function is capable of estimating the probabilities of obtaining each of the categories using Bayes theorem</p>
</blockquote>
<script type="math/tex; mode=display">
   p(y^k= 1|x)=\frac{p(x|y^k = 1)p(y^k = 1)}{p(x)}=\frac{e^{-z_k(x; \theta)}}{\sum_{j=1}^Ne^{-z_j(x; \theta)} }
</script>

            </section>
        

    </section>
    



    
        <section >
            
            <h3><a id="user-content-422-regression-output-layer" class="anchor" href="#422-regression-output-layer" aria-hidden="true"></a>4.2.2 regression output layer</h3>
<p>The output layer consists on a dense layer with a linear activation function</p>
  <img data-src="./images/Output regression.png" width = "50%">
<p>It transforms the output into the estimated value of each component</p>

            </section>
    



    
        <section data-transition="slide" data-background="#3cb1b5" data-background-transition="zoom">
            
            <!-- .slide: data-transition="slide" data-background="#3cb1b5" data-background-transition="zoom" -->
<h2><a id="user-content-5-results" class="anchor" href="#5-results" aria-hidden="true"></a>5. Results</h2>

            </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-51-action-classification-model" class="anchor" href="#51-action-classification-model" aria-hidden="true"></a>5.1 action classification model</h3>
 <img data-src="./images/S2A step.png">

            </section>
        
            <section >
                <h3><a id="user-content-511-action-classification-model" class="anchor" href="#511-action-classification-model" aria-hidden="true"></a>5.1.1 action classification model</h3>
<section style="text-align: left;">
The configuration is as follows:
<ul>
<li>Input layer: last predicted state $x_{t-1}$</li>
<li>The recurrent layer: is expected to learn the function $h_{t} = f(h_{t-1}; x_{t-1})$</li>
<li>Output layer: probabilities for the next action to apply a_{t}.</li>
<li>Fixed function: $x_t=F(x_{t-1};a_t)$</li>
</ul>
</section>

            </section>
        
            <section >
                <h3><a id="user-content-511-action-classification-model-1" class="anchor" href="#511-action-classification-model-1" aria-hidden="true"></a>5.1.1 action classification model</h3>
<p>Network summary</p>
<table>
<thead>
<tr>
<th>Layer</th>
<th style="text-align:center">Output shape</th>
<th style="text-align:center">parameter number</th>
</tr>
</thead>
<tbody>
<tr>
<td>LSTM</td>
<td style="text-align:center">[None, None, 11]</td>
<td style="text-align:center">792</td>
</tr>
<tr>
<td>Dense</td>
<td style="text-align:center">[None, None, 35]</td>
<td style="text-align:center">420</td>
</tr>
<tr>
<td>Lambda</td>
<td style="text-align:center">[None, None, 6]</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-512-action-classification-training" class="anchor" href="#512-action-classification-training" aria-hidden="true"></a>5.1.2 action classification training</h3>
<p>We use the KL divergence loss function as the measure of the dissimilarity between these two distributions
$$\displaystyle D_{\text{KL}}(p_{data}\parallel p_{model})=\sum_{x\in {\mathcal{X}}}p(a|x)\log \left({\frac {p(a|x)}{p(a|x;\theta)}}\right)$$
to estimate $\hat{a} = p(a|x;\theta)$ as close as possible to the true action category value $p(a|x)$.</p>

            </section>
        
            <section >
                <h3><a id="user-content-512-action-classification-training-1" class="anchor" href="#512-action-classification-training-1" aria-hidden="true"></a>5.1.2 action classification training</h3>
<img data-src="./images/S2A loss curve.png">

            </section>
        

    </section>
    



    
    <section>
        <section >
            <h3><a id="user-content-513-action-classification-results" class="anchor" href="#513-action-classification-results" aria-hidden="true"></a>5.1.3 action classification results</h3>
<img data-src="./images/S2A trajectory.png" width = 45%>
<img data-src="./images/S2A trajectory components.png" width = 45%>

            </section>
        
            <section >
                <h3><a id="user-content-513-action-classification-results-1" class="anchor" href="#513-action-classification-results-1" aria-hidden="true"></a>5.1.3 action classification results</h3>
<p>Results summary</p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th style="text-align:center">Cost (W)</th>
<th style="text-align:center">Time (s)</th>
<th style="text-align:center">Precision (m)</th>
<th style="text-align:center">Trajectory error (m)</th>
</tr>
</thead>
<tbody>
<tr>
<td>OSPA</td>
<td style="text-align:center">34.68</td>
<td style="text-align:center">520</td>
<td style="text-align:center">2.84</td>
<td style="text-align:center">N/A</td>
</tr>
<tr>
<td>Action prediction</td>
<td style="text-align:center">37.25</td>
<td style="text-align:center">0.43</td>
<td style="text-align:center">6.29</td>
<td style="text-align:center">3.85</td>
</tr>
</tbody>
</table>

            </section>
        

    </section>
    



    
        <section >
            
            <h3><a id="user-content-53-decoder-model" class="anchor" href="#53-decoder-model" aria-hidden="true"></a>5.3 Decoder model</h3>
 <img data-src="./images/Decoder.png">

            </section>
    



    
        <section >
            
            <h3><a id="user-content-54-ode-integrator-model" class="anchor" href="#54-ode-integrator-model" aria-hidden="true"></a>5.4 ODE integrator model</h3>
 <img data-src="./images/ODE.png">
<hr>

            </section>
    


    </div>


  </div>

  <script src="libs/reveal.js/3.8.0/lib/js/head.min.js"></script>
  <script src="libs/reveal.js/3.8.0/js/reveal.js"></script>

  <script>

    // More info https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({

        controls: true,
        controlsTutorial: true,
        controlsLayout: 'bottom-right',
        controlsBackArrows: 'faded',
        progress: true,
        slideNumber: false,
        history: true,
        keyboard: true,
        overview: true,
        center: true,
        touch: true,
        loop: false,
        rtl: false,
        shuffle: false,
        fragments: true,
        fragmentInURL: false,
        embedded: false,
        help: true,
        showNotes: false,
        autoPlayMedia: false,
        autoSlide: 0,
        autoSlideStoppable: true,
        autoSlideMethod: Reveal.navigateNext,
        defaultTiming: 120,
        mouseWheel: false,
        hideAddressBar: true,
        previewLinks: false,
        transition: 'slide',
        transitionSpeed: 'default',
        backgroundTransition: 'default',
        viewDistance: 3,
        parallaxBackgroundImage: '',
        parallaxBackgroundSize: '',
        parallaxBackgroundHorizontal: 0,
        parallaxBackgroundVertical: 0,
        display: 'block',

        // More info https://github.com/hakimel/reveal.js#dependencies
        dependencies: [
            // { src: 'libs/reveal.js/3.8.0/lib/js/classList.js', condition: function () { return !document.body.classList; } },
            // { src: 'libs/reveal.js/3.8.0/plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            // { src: 'libs/reveal.js/3.8.0/plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
            // { src: 'libs/reveal.js/3.8.0/plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
            { src: 'libs/reveal.js/3.8.0/plugin/notes/notes.js', async: true },
            { src: 'libs/reveal.js/3.8.0/plugin/chart/Chart.min.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/chart/csv2chart.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/embed-tweet/embed-tweet.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/math/math.js', async: true },
            { src: 'libs/highlight.js/9.12.0/highlight.js', async: true },
            { src: 'libs/reveal.js/3.8.0/plugin/anything/anything.js' },
            { src: 'libs/reveal.js/3.8.0/plugin/mermaid/mermaid.min.js', async: true, callback: function() {mermaid.initialize({startOnLoad:false})} },	

           
        { src: 'libs/reveal.js/3.8.0/plugin/search/search.js', async: true },
           

           
        { src: 'libs/reveal.js/3.8.0/plugin/zoom-js/zoom.js', async: true },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/chalkboard/chalkboard.js' },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/menu/menu.js' },
            

            
        { src: 'libs/reveal.js/3.8.0/plugin/title-footer/title-footer.js', async: true, callback: function () { title_footer.initialize(); } },
            

        {
            src: 'libs/highlight.js/9.12.0/reveal-code-focus-1.0.0-mod.js',
            async: true,
            callback: function () {
                RevealCodeFocus();
            }
        },
            // { src: 'libs/reveal.js/3.8.0/plugin/reveal-code-focus/highlight.pack.js' },
            // { src: 'libs/reveal.js/3.8.0/plugin/reveal-code-focus/reveal-code-focus.js', async: true, callback: function() { RevealCodeFocus(); } },
           // {src: 'libs/reveal.js/3.8.0/plugin/line-numbers/line-numbers.js'}
        ]
        ,
    keyboard: {
        67: function () { RevealChalkboard.toggleNotesCanvas() },	// toggle notes canvas when 'c' is pressed
        66: function () { RevealChalkboard.toggleChalkboard() },	// toggle chalkboard when 'b' is pressed
        46: function () { RevealChalkboard.clear() },	// clear chalkboard when 'DEL' is pressed
        8: function () { RevealChalkboard.reset() },	// reset chalkboard data on current slide when 'BACKSPACE' is pressed
        68: function () { RevealChalkboard.download() },	// downlad recorded chalkboard drawing when 'd' is pressed
    },
    math: {
       // mathjax: 'libs/reveal.js/3.8.0/plugin/math/MathJax.js',
             mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
            config: 'TeX-AMS_HTML-full'
    },
    chart: {
        defaults: {
            global: {
                title: { fontColor: "#FFF" },
                legend: {
                    position: "bottom",
                        labels: { fontColor: "#FFF" },
                },
                tooltips: {
                    labels: { fontColor: "#FFF" },
                },
            },
            scale: {
                scaleLabel: { fontColor: "#FFF" },
                gridLines: { color: "#FFF", zeroLineColor: "#FFF" },
                ticks: { fontColor: "#FFF" },
            }
        },
        line: { borderColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"], "borderDash": [[5, 10], [0, 0]] },
        bar: { backgroundColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"] },
        pie: { backgroundColor: [["rgba(0,0,0,.8)", "rgba(220,20,20,.8)", "rgba(20,220,20,.8)", "rgba(220,220,20,.8)", "rgba(20,20,220,.8)"]] },
        radar: { borderColor: ["rgba(20,220,220,.8)", "rgba(220,120,120,.8)", "rgba(20,120,220,.8)"] },
    },
    anything: [ 
	 {
	  className: "mermaid"
	 },
	 // ...
	],
    menu: {
        // Specifies which side of the presentation the menu will 
        // be shown. Use 'left' or 'right'.
        side: 'left',

            // Specifies the width of the menu.
            // Can be one of the following:
            // 'normal', 'wide', 'third', 'half', 'full', or
            // any valid css length value
            width: 'normal',

                // Add slide numbers to the titles in the slide list.
                // Use 'true' or format string (same as reveal.js slide numbers)
                numbers: false,

                    // Specifies which slide elements will be used for generating
                    // the slide titles in the menu. The default selects the first
                    // heading element found in the slide, but you can specify any
                    // valid css selector and the text from the first matching
                    // element will be used.
                    // Note: that a section data-menu-title attribute or an element
                    // with a menu-title class will take precedence over this option
                    titleSelector: 'h1, h2, h3, h4, h5, h6',

                        // If slides do not have a matching title, attempt to use the
                        // start of the text content as the title instead
                        useTextContentForMissingTitles: false,

                            // Hide slides from the menu that do not have a title.
                            // Set to 'true' to only list slides with titles.
                            hideMissingTitles: false,

                                // Adds markers to the slide titles to indicate the 
                                // progress through the presentation. Set to 'false'
                                // to hide the markers.
                                markers: true,

                                    // Specify custom panels to be included in the menu, by
                                    // providing an array of objects with 'title', 'icon'
                                    // properties, and either a 'src' or 'content' property.
                                    // custom: false,
                                    custom: [],
                                        // Specifies the themes that will be available in the themes
                                        // menu panel. Set to 'true' to show the themes menu panel
                                        // with the default themes list. Alternatively, provide an
                                        // array to specify the themes to make available in the
                                        // themes menu panel, for example...
                                        // [
                                        //     { name: 'Black', theme: 'css/theme/black.css' },
                                        //     { name: 'White', theme: 'css/theme/white.css' },
                                        //     { name: 'League', theme: 'css/theme/league.css' }
                                        // ]
                                        themes: false,

                                            // Specifies the path to the default theme files. If your
                                            // presentation uses a different path to the standard reveal
                                            // layout then you need to provide this option, but only
                                            // when 'themes' is set to 'true'. If you provide your own 
                                            // list of themes or 'themes' is set to 'false' the 
                                            // 'themesPath' option is ignored.
                                            themesPath: 'css/theme/',

                                                // Specifies if the transitions menu panel will be shown.
                                                // Set to 'true' to show the transitions menu panel with
                                                // the default transitions list. Alternatively, provide an
                                                // array to specify the transitions to make available in
                                                // the transitions panel, for example...
                                                // ['None', 'Fade', 'Slide']
                                                transitions: false,

                                                    // Adds a menu button to the slides to open the menu panel.
                                                    // Set to 'false' to hide the button.
                                                    openButton: true,

                                                        // If 'true' allows the slide number in the presentation to
                                                        // open the menu panel. The reveal.js slideNumber option must 
                                                        // be displayed for this to take effect
                                                        openSlideNumber: false,

                                                            // If true allows the user to open and navigate the menu using
                                                            // the keyboard. Standard keyboard interaction with reveal
                                                            // will be disabled while the menu is open.
                                                            keyboard: true,

                                                                // Normally the menu will close on user actions such as
                                                                // selecting a menu item, or clicking the presentation area.
                                                                // If 'true', the sticky option will leave the menu open
                                                                // until it is explicitly closed, that is, using the close
                                                                // button or pressing the ESC or m key (when the keyboard 
                                                                // interaction option is enabled).
                                                                sticky: false,

                                                                    // If 'true' standard menu items will be automatically opened
                                                                    // when navigating using the keyboard. Note: this only takes 
                                                                    // effect when both the 'keyboard' and 'sticky' options are enabled.
                                                                    autoOpen: true,

                                                                        // If 'true' the menu will not be created until it is explicitly
                                                                        // requested by calling RevealMenu.init(). Note this will delay
                                                                        // the creation of all menu panels, including custom panels, and
                                                                        // the menu button.
                                                                        delayInit: false,

                                                                            // If 'true' the menu will be shown when the menu is initialised.
                                                                            openOnInit: false,

                                                                                // By default the menu will load it's own font-awesome library
                                                                                // icons. If your presentation needs to load a different
                                                                                // font-awesome library the 'loadIcons' option can be set to false
                                                                                // and the menu will not attempt to load the font-awesome library.
                                                                                loadIcons: false
    },
    chalkboard: {
        toggleChalkboardButton: { left: "60px", bottom: "30px", top: "auto", right: "auto" },
        toggleNotesButton: { left: "90px", bottom: "30px", top: "auto", right: "auto" },

    }
    });



</script>
</body>

</html>